"use client";
import { jsx, jsxs } from "react/jsx-runtime";
import { c as _c } from "react-compiler-runtime";
import cn from "clsx";
import { Children, cloneElement, useEffect, useRef, useState } from "react";
import { Collapse } from "../components/collapse.js";
const Details = (t0) => {
  const $ = _c(22);
  let children;
  let className;
  let open;
  let props;
  if ($[0] !== t0) {
    ({
      children,
      open,
      className,
      ...props
    } = t0);
    $[0] = t0;
    $[1] = children;
    $[2] = className;
    $[3] = open;
    $[4] = props;
  } else {
    children = $[1];
    className = $[2];
    open = $[3];
    props = $[4];
  }
  const [isOpen, setIsOpen] = useState(!!open);
  const [delayedOpenState, setDelayedOpenState] = useState(isOpen);
  const animationRef = useRef(0);
  let t1;
  let t2;
  if ($[5] !== isOpen) {
    t1 = () => {
      const animation = animationRef.current;
      if (animation) {
        clearTimeout(animation);
        animationRef.current = 0;
      }
      if (!isOpen) {
        animationRef.current = window.setTimeout(() => setDelayedOpenState(isOpen), 300);
        return () => {
          clearTimeout(animationRef.current);
        };
      }
      setDelayedOpenState(true);
    };
    t2 = [isOpen];
    $[5] = isOpen;
    $[6] = t1;
    $[7] = t2;
  } else {
    t1 = $[6];
    t2 = $[7];
  }
  useEffect(t1, t2);
  let t3;
  if ($[8] !== children) {
    t3 = findSummary(children, setIsOpen);
    $[8] = children;
    $[9] = t3;
  } else {
    t3 = $[9];
  }
  const [summaryElement, restChildren] = t3;
  let t4;
  if ($[10] !== className) {
    t4 = cn("x:not-first:mt-4 x:rounded x:border x:border-gray-200 x:bg-white x:p-2 x:shadow-sm x:dark:border-neutral-800 x:dark:bg-neutral-900", "x:overflow-hidden", className);
    $[10] = className;
    $[11] = t4;
  } else {
    t4 = $[11];
  }
  const t5 = isOpen || delayedOpenState;
  const t6 = isOpen ? "" : void 0;
  let t7;
  if ($[12] !== isOpen || $[13] !== restChildren) {
    t7 = /* @__PURE__ */ jsx(Collapse, { isOpen, children: restChildren });
    $[12] = isOpen;
    $[13] = restChildren;
    $[14] = t7;
  } else {
    t7 = $[14];
  }
  let t8;
  if ($[15] !== props || $[16] !== summaryElement || $[17] !== t4 || $[18] !== t5 || $[19] !== t6 || $[20] !== t7) {
    t8 = /* @__PURE__ */ jsxs("details", { className: t4, ...props, open: t5, "data-expanded": t6, children: [
      summaryElement,
      t7
    ] });
    $[15] = props;
    $[16] = summaryElement;
    $[17] = t4;
    $[18] = t5;
    $[19] = t6;
    $[20] = t7;
    $[21] = t8;
  } else {
    t8 = $[21];
  }
  return t8;
};
function findSummary(list, setIsOpen) {
  let summary;
  const rest = Children.map(list, (child) => {
    if (!summary && // Add onClick only for first summary
    child && typeof child === "object" && "type" in child) {
      if (child.type === "summary") {
        summary = cloneElement(child, {
          onClick(event) {
            event.preventDefault();
            setIsOpen((v) => !v);
          }
        });
        return;
      }
      if (child.type !== Details && child.props.children) {
        ;
        [summary, child] = findSummary(child.props.children, setIsOpen);
      }
    }
    return child;
  });
  return [summary, rest];
}
export {
  Details
};
